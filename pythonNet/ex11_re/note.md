# 正则表达式

## 动机
1. 文本处理已经成为计算机的常见工作之一
2. 对文本内容的搜索,定位,提取是逻辑比较复杂的工作
3. 为了快速方便的解决上述问题,产生了正则表达式  
## 定义: 
- 即文本的高级匹配模式,提供搜索替换功能.其本质是一系列由字符和特殊符号组成的字符串,这个字符串即正则表达式
## 匹配原理: 
- 由普通的字符和特殊符号构成,通过描述字符的重复,位置,种类等行为达到匹配某一类字符串的目的
## 正则特点
- 方便处理文本
- 支持语言众多
- 使用灵活多样
## 目标:
1. 熟练掌握正则表达式符号
2. 读懂正则表达式,编写简单的正则表达式
3. 能够使用python  re 操作正则表达式  

# re 模块

## regex = re.compile(pattern,flags = 0)
- 功能 : 生成正则表达式对象
- 参数: 
    - pattern 正则表达式对象
    - flags 功能标识,用来丰富正则表达式功能
- 返回一个正则表达式对象

## re.findall(pattern,string,flags)
- 使用正则表达式匹配字符串
- 参数
    - pattern 正则表达式
    - string 目标字符串
    - flags  标志位
- 返回值: 返回匹配内容的列表, 如果正则表达式有子组,则只获取子组对应内容


## regex.findall(string,pos,endpos)
- 功能: 使用正则表达式匹配目标字符串
- 参数: string 目标字符串
    - pos 匹配目标的起始位置
    - endpos 匹配目标的结束位置
- 返回值: 
        - 列表, 匹配到的内容
    - 如果正则表达式有子组则只获取子组对应内容

## re.split(patterm, string, flags)
- 功能 : 使用正则匹配到的部分切割目标字符串
- 参数 : 
    - pattern 正则
    - string 目标子串
    - flags 标志位
- 返回值: 返回列表,为切割后内容

## re.sub(pattern,replaceStr,string,max,flage)
- 功能: 使用字符串替换匹配到的内容
- 参数: 
    - replaceStr 替换字串
    - max最多替换计数,默认全部替换
- 返回值: 返回替换后的字符串

## re.subn(pattern,replaceStr,string,max,flage)
- 功能参数同sub
- 返回值: 返回替换后的字符串和替换数量

## finditer(pattern, string, flags)
- 功能: 使用正则表达式匹配目标字符串
- 参数
    - pattern 正则
    - string 目标字串
    - flags 标志位
- 返回值: 返回一个包含匹配内容的迭代对象

## re.fullmatch(pattern,string,flags)
- 功能: 完全匹配 相当于在正则两端加^$
- 参数: pattern string flags
- 返回值 match对象
## re.match(pattern,string,flags)
- 功能: 匹配一个目标字符串的开始位置
- 参数: pattern string flags
- 返回值 match对象

## re.search(pattern, string, flags)
- 功能 : 匹配目标字符串第一处匹配的内容
- 参数
    - pattern 正则
    - string 目标字串
    - flags 标志位
- 返回值: match对象

## complie对象属性变量
- flags : 标志位
- pattern 正则表达式
-  groups: 有多少子组
- groupindex: 铺货组形成组名和序列号的字典组名为键 几组为值

# match对象属性和函数
## 属性
- obj.pos# 目标字串开始位置
- obj.endpos# 目标字串结束位置
- obj.re # 正则表达式
- obj.string # 目标字符串
- obj.lastgroup# 显示最后一组组名,如果没有名字则显示不出来
- obj.lastindex# 最后一组序列号
## 方法
- print(obj.group(n))
    - 获取match对象的对应内容, 
    - 参数: 默认为0表示获取match对象所有对应内容,  
    如果为>0整数则表示某个子组对应内容  
    如果为子组名称则表示该组对应内容
- print(obj.groupdict())
    - 获取捕获组和对应值的字典
- print(obj.groups())
    - 获取所有子组对应内容


# 元字符的使用
1. 普通字符
    - 元字符: a B c
    - 匹配 : 单个字符,

2. 或
    - 元字符: |
    - 匹配规则: 匹配|两边任意一个正则表达式
3. 匹配单个字符
    - 元字符: .
    - 匹配规则: 匹配除换行外任意一个字符
4. 匹配字符串开始位置
    - 元字符: ^
    - 匹配规则: 匹配目标字符串的开始位置
5. 匹配字符串结束位置
    - 元字符: $
    - 匹配规则: 匹配目标字符串的结束位置
6. 匹配重复********
    - 元字符: *
    - 匹配规则: 匹配前面的字符出现0次或多次
7. 匹配重复++++++++
    - 元字符: +
    - 匹配规则: 匹配日前面的字符出现一次或多次
8. 匹配重复:????????
    - 元字符: ?
    - 匹配规则: 匹配前面的字符出现一次或零次
9. 匹配重复: {}
    - 元字符:{n}
    - 匹配规则: 匹配前面的字符重复指定的次数
    - fo{3} --> fooo
10. 匹配重复: {m,n}
    - 元字符:{m,n}
    - 匹配规则: 匹配前面的字符出现m--n次
    - fo{2,4} --> foo fooo foooo
11. 匹配字符集[字符集]
    - 元字符: [字符集]
    - 匹配规则: 匹配字符集中任意一个字符
    - [abc123] -- > a b c 1 2 3 
    - [a-z]  [A-Z]  [0-9]
    - [$#_a-z]
12. 匹配字符集
    - 元字符:[^...]
    - 匹配规则: 匹配除制定字符外的任意一个字符
    - [^abc] --> 除了abc外的任意一个字符
    ```
    >>> re.findall("[^ ]","This is a test")
    ['T', 'h', 'i', 's', 'i', 's', 'a', 't', 'e', 's', 't']
    >>> re.findall("[^ ]+","This is a test")
    ['This', 'is', 'a', 'test']
    ```
13. 匹配任意(非)数字字符
    - 元字符: \d ---- \D
    - 匹配规则:
        - \d匹配任意一个数字字符[0-9]
        - \D匹配任意一个非数字字符[^0-9]

14. 匹配任意(非)普通字符
    - 元字符: \w \W
    - 匹配规则
        - \w匹配普通字符 (字母数字下划线,utf8字符(汉子))
        - \W匹配非普通字符  (!@#$%^&*()+-*/ =`等)
15. 匹配任意(非)空字符串
    - 元字符: \s \S
    - 匹配规则
        - \s 匹配任意空字符串 [\r \n \t \v \f]
        - \S 匹配任意非空

16. 匹配字符串开头结尾位置
    - 元字符: \A \Z
    - 匹配规则
        - \A 匹配字符串开头位置
        - \Z 匹配字符串结尾位置
- 绝对匹配(完全匹配): 
    - 保证正则表达式匹配目标字符串的全部内容
17. 匹配(非)单词便捷
    - 元字符: \b  \B
    - 匹配规则: 
        - \b匹配单词边界 (普通字符和其他字符的交接)
        - \B匹配非单词边界  
    - 单词边界

## 元字符总结
- 匹配单个字符: . [...] [^...] \d \D \w \W \s \S
- 匹配重复 *+? {n} {m,n}
- 匹配位置: ^ $ \A \Z \b \B
- 其他: |() \

## 正则表达式的转意
- 正则特殊符号 : . *+?^$()[] | \
- 正则表达式如果匹配特殊字本身符则需要加\
- raw子串: 对字符串不进行转义解析

## 贪婪和非贪婪
- 贪婪模式 : 正则表达式的重复匹配默认总是尽可能多的向后匹配内容
-  ?  + *  {m,n}

- 非贪婪(懒惰)模式: 尽可能少的匹配内容
    - 贪婪-->费贪婪  *? +? ??  {m,n}?

## 正则表达式分组
使用()可以为正则表达式内部建立分组.通过分组构建正则表达式的内部整体处理部分
- 字组是正则表达式的一部分，子组需要再**整体能后匹配到内容的前提下发挥作用**

## 子组的作用
1. 作为一个内部整体,改变某些元字符的操作对象
2. 在匹配到内容的前提下  
`re.search(r"(http|https|ftp)://\S+",'https://www.baidu.com').group()`  
`'https://www.baidu.com'`

## 捕获组和非捕获组
- 捕获组: 被命名的子组
    - 格式 : `(?p<name>pattern)`
    - 作用: 名字可以表达一定的含义,也可以通过名字来提取子组对应内容
    - `>>> re.search(r"(?P<big>[A-Z])\w*",'Hello World').group('big')`  
        `'H'`
- 一个正则表达式中可以有多个子组,多个子组尽量不要重叠或者过多嵌套.通常由外到内,从左到右为第一第二子组

# 正则表达式的设计原则
1. 正确性: 能够正确的匹配目标字符串
2. 排他性: 除了要匹配的内容,尽可能不会匹配到其他多余内容
3. 全面性: 尽可能将目标字符串的全部情况考虑全面,不遗漏
